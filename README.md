# 转粮数据汇总工具

自动读取转粮数据文件中的"总产出重量"，并按顺序汇总到汇总Excel文件。

## 功能特点

- ✅ 自动识别所有转粮数据文件（支持任意文件编号）
- ✅ 智能提取"总产出重量"值（多种查找策略，适应格式变化）
- ✅ 按数字大小正确排序（而非字符串排序）
- ✅ 自动创建或更新汇总文件
- ✅ 支持动态文件编号范围（如 623、709、1101 等）
- ✅ 自动添加新列（如果汇总文件中缺少对应列）

## 使用方法

### 方法一：使用Python脚本（需要Python环境）

1. 安装依赖：
```bash
pip install -r requirements.txt
```

2. 运行脚本：
```bash
python 汇总脚本.py
```

或使用启动脚本：
```bash
./运行汇总.sh  # Linux/Mac
运行汇总.bat   # Windows
```

### 方法二：使用打包后的exe程序（推荐，无需Python）

1. 在Windows系统上打包（见下方打包说明）
2. 将生成的 `转粮数据汇总工具.exe` 复制到转粮数据文件目录
3. 双击运行即可

## Windows打包说明

### 快速打包

双击运行 `build_windows.bat` 即可自动打包。

### 手动打包

1. 安装PyInstaller：
```bash
pip install pyinstaller
```

2. 打包程序：
```bash
pyinstaller --onefile --name=转粮数据汇总工具 --console 汇总脚本.py
```

3. 找到生成的文件：
```
dist/转粮数据汇总工具.exe
```

详细说明请查看 `Windows打包指南.md`

## 文件说明

- `汇总脚本.py` - 主程序脚本
- `运行汇总.sh` - Linux/Mac启动脚本
- `运行汇总.bat` - Windows启动脚本
- `build_windows.bat` - Windows自动打包脚本
- `requirements.txt` - Python依赖列表
- `Windows打包指南.md` - 详细的打包说明

## 使用示例

### 输入文件
- `709转粮数据.xls`
- `710转粮数据.xls`
- `711转粮数据.xls`
- ...（任意编号）

### 输出文件
- `汇总.xlsx` - 自动生成或更新

### 汇总文件格式
```
第1行：中心名词 | 709 | 710 | 711 | ...
第2行：数量    | 值1 | 值2 | 值3 | ...
```

## 系统要求

### Python版本
- Python 3.7 或更高版本

### 依赖库
- pandas >= 1.5.0
- openpyxl >= 3.0.0
- xlrd >= 2.0.0

### Windows打包
- Windows 7 或更高版本
- 已安装Python环境（仅打包时需要）

## 注意事项

1. **文件位置**：脚本需要在包含转粮数据文件的目录中运行
2. **文件格式**：支持 `.xls` 和 `.xlsx` 格式
3. **文件命名**：文件名格式应为 `数字转粮数据.xls`（如 `709转粮数据.xls`）
4. **汇总文件**：如果不存在会自动创建，如果存在会自动更新

## 常见问题

### Q: 找不到"总产出重量"怎么办？
A: 脚本使用多种策略查找，如果仍然找不到，请检查转粮数据文件格式是否正确。

### Q: 文件编号不连续可以吗？
A: 可以，脚本会自动按数字大小排序，支持不连续的编号。

### Q: 可以处理单个文件吗？
A: 可以，支持处理任意数量的文件（1个或多个）。

### Q: 打包后的exe文件很大？
A: 正常现象，因为包含了Python解释器和所有依赖库（约50-100MB）。

## 更新日志

### v1.0
- 初始版本
- 支持读取转粮数据文件
- 支持自动汇总到Excel
- 支持动态文件编号范围
- 支持自动创建汇总文件

