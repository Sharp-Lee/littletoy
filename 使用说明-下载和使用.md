# 转粮数据汇总工具 - 使用说明

## 📥 如何下载

### 方法一：从GitHub Actions下载（推荐）

1. **访问GitHub仓库**
   - 打开：https://github.com/Sharp-Lee/littletoy
   - 点击顶部的 **"Actions"** 标签

2. **找到最新的打包记录**
   - 在左侧选择 **"Build Windows Executable"** 工作流
   - 点击最新的运行记录（绿色✓表示成功）

3. **下载打包结果**
   - 滚动到页面底部的 **"Artifacts"** 部分
   - 点击 **"转粮数据汇总工具-Windows"** 下载
   - 下载的是一个zip压缩包

4. **解压文件**
   - 解压zip文件
   - 得到 `转粮数据汇总工具.exe`

### 方法二：从GitHub Release下载

如果创建了Release标签：

1. 访问：https://github.com/Sharp-Lee/littletoy/releases
2. 找到最新的Release版本
3. 下载 `转粮数据汇总工具.exe`

## 🚀 如何使用

### 步骤1：准备文件

1. **准备转粮数据文件**
   - 将所有转粮数据文件放在同一个文件夹中
   - 文件命名格式：`数字转粮数据.xls` 或 `数字转粮数据.xlsx`
   - 例如：`709转粮数据.xls`、`710转粮数据.xls`、`1101转粮数据.xls` 等

2. **复制exe文件**
   - 将 `转粮数据汇总工具.exe` 复制到转粮数据文件所在的文件夹

### 步骤2：运行程序

1. **双击运行**
   - 双击 `转粮数据汇总工具.exe`
   - 会弹出一个黑色命令行窗口（这是正常的）

2. **查看运行过程**
   - 程序会显示处理进度：
     ```
     找到 11 个转粮数据文件
     文件编号范围: 709 - 719
     正在处理: 709转粮数据.xls
       ✓ 找到总产出重量: 39579.0
     ...
     ```

3. **等待完成**
   - 程序会自动处理所有转粮数据文件
   - 处理完成后会显示：
     ```
     ✓ 汇总完成！共处理 11 个文件
     ```
   - 按任意键关闭窗口

### 步骤3：查看结果

1. **打开汇总文件**
   - 在转粮数据文件所在的文件夹中
   - 找到生成的 `汇总.xlsx` 文件
   - 用Excel打开查看

2. **汇总文件格式**
   - **第1行**：中心名词 | 709 | 710 | 711 | ...（文件编号）
   - **第2行**：数量 | 39579 | 41382 | 25352 | ...（总产出重量值）

## 📋 使用示例

### 文件夹结构示例

```
我的转粮数据/
├── 转粮数据汇总工具.exe    ← 程序文件
├── 709转粮数据.xls         ← 转粮数据文件
├── 710转粮数据.xls
├── 711转粮数据.xls
├── ...
└── 汇总.xlsx               ← 自动生成的汇总文件
```

### 运行效果示例

```
找到 11 个转粮数据文件
文件编号范围: 709 - 719
正在处理: 709转粮数据.xls
  ✓ 找到总产出重量: 39579.0
正在处理: 710转粮数据.xls
  ✓ 找到总产出重量: 41382.0
...

正在更新汇总文件: 汇总.xlsx
  找到列 709 在列索引 2
  找到列 710 在列索引 3
  ...
  ✓ 已写入 709 列（第2行，第2列）: 39579.0
  ✓ 已写入 710 列（第2行，第3列）: 41382.0
  ...

✓ 汇总完成！共处理 11 个文件
```

## ⚠️ 常见问题

### Q1: 双击exe没有反应？

**解决方法：**
- 右键点击exe文件 → 选择"以管理员身份运行"
- 检查是否被杀毒软件拦截，添加到白名单
- 确保exe文件和转粮数据文件在同一文件夹

### Q2: 提示"找不到转粮数据文件"？

**解决方法：**
- 确保转粮数据文件命名正确：`数字转粮数据.xls` 或 `数字转粮数据.xlsx`
- 确保exe文件和转粮数据文件在同一文件夹
- 检查文件名中是否包含"转粮数据"关键词

### Q3: 提示"未找到总产出重量"？

**解决方法：**
- 检查转粮数据文件格式是否正确
- 确保文件中包含"总产出重量"标签
- 如果文件格式有变化，可能需要更新程序

### Q4: 汇总文件没有更新？

**解决方法：**
- 关闭Excel文件后再运行程序
- 检查是否有写入权限
- 查看命令行窗口的错误信息

### Q5: 程序窗口一闪而过？

**解决方法：**
- 程序可能运行很快，这是正常的
- 如果出错，可以在命令行中运行查看详细错误：
  - 按 `Win + R`，输入 `cmd`，按回车
  - 进入exe文件所在目录
  - 输入 `转粮数据汇总工具.exe` 运行

### Q6: 杀毒软件报毒？

**解决方法：**
- 这是误报，因为PyInstaller打包的程序可能被误判
- 添加到杀毒软件白名单即可
- 或者从GitHub官方仓库下载，确保来源可靠

## 💡 使用技巧

1. **批量处理**：可以一次性处理任意数量的转粮数据文件
2. **自动排序**：文件编号会自动按数字大小排序（不是字符串排序）
3. **自动创建**：如果汇总文件不存在，会自动创建
4. **自动更新**：如果汇总文件已存在，会自动更新对应列的数据
5. **自动添加列**：如果汇总文件中缺少某个文件编号的列，会自动添加

## 📝 注意事项

1. ✅ exe文件需要和转粮数据文件放在同一文件夹
2. ✅ 运行前关闭汇总.xlsx文件（如果已打开）
3. ✅ 确保有足够的磁盘空间
4. ✅ 建议定期备份汇总.xlsx文件
5. ✅ 支持的文件格式：.xls 和 .xlsx

## 🔄 更新程序

如果需要更新到新版本：

1. 从GitHub Actions下载最新版本的exe文件
2. 替换旧的exe文件
3. 重新运行即可

---

**需要帮助？** 查看 `README.md` 或提交Issue到GitHub仓库。

